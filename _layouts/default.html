<!DOCTYPE html>
	<html>
		<head>
			<meta name="viewport" content="width=device-width">
			<title>{{ site.github.project_title }}</title>
			<!--[if IE]><link rel="shortcut icon" href="assets/images/favicon.ico"><![endif]-->
			<link rel="icon" href="assets/images/favicon.png">
			<link href="https://fonts.googleapis.com/css?family=Anonymous+Pro:400,700|Roboto+Slab:100,300,400,700" rel="stylesheet">
			<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
			<link rel="stylesheet" type="text/css" href="assets/css/style.css">
			<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
			<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js" integrity="sha384-u/bQvRA/1bobcXlcEYpsEdFVK/vJs3+T+nXLsBYJthmdBuavHvAW6UsmqO2Gd/F9" crossorigin="anonymous"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js" crossorigin="anonymous"></script>
			
		</head>
		<body>
			<header>
				<div class="container">
					<div class="row">
						<div class="col-md-1">
							<i id="menu-btn" class="fas fa-bars"></i>
						</div>
					</div>
					<div class="row" id="profile-title-box">
						<div class="col-md-12">
							<div id="inner-photo-box">
								<img src="assets/images/profile.jpg">
							</div>

							<div id="inner-title-box">
								<h1>{{ site.github.project_title }}</h1>
								<h3>{{ page.tagline }}</h3>
							</div>
						</div>
					</div>
				</div>
			</header>
			<div class="container">
				<div id="sub-header" class="d-flex flex-row align-content-center">
					<div id="sub-header-repos" class="flex-fill sub-header-item">
						<div class="sub-header-item-inner d-flex align-items-center flex-wrap">
							<h5 class="align-self-center">12</h5><span>repositories</span>
						</div>
						
					</div>
					<div id="sub-header-gists" class="flex-fill sub-header-item">
						<div class="sub-header-item-inner d-flex align-items-center flex-wrap">
							<h5 class="align-self-center">4</h5><span>gists</span>
						</div>
						
					</div>
					<div id="sub-header-languages" class="flex-fill sub-header-item">
						<div class="sub-header-item-inner d-flex align-items-center flex-wrap">
							<h5 class="align-self-center">8</h5><span>languages</span>
						</div>
						
					</div>
				</div>
			</div>
			<div id="main-content">
				<div class="container">
					{% assign sorted = site.github.public_repositories | sort:"created_at" | reverse %}
					{% assign sorted = site.github.public_repositories | sort:"created_at" | reverse %}
					<div class="row">
						<div id="public-repo-box" class="col-md-8"> 	
							<h5>
								<i class="fas fa-database"></i>
								public repos
							</h5>
							<ul id="public-repo-list" class="list-group list-group-flush">
								{% for repos in sorted %}
									{% if forloop.index0 < 3 %}
										<li class="list-group-item list-item-title list-item-preview" data-repo-id="{{ repos.id }}">
										  	<a href="{{ repos.html_url }}">{{ repos.name }}
										  		<i class="fas fa-sort-down"></i>
										  		<div class="list-item-expanded">
										  			<p>
										  				{{ repos.description }}	
										  			</p>	
										  		</div>
										  	</a>
										</li>
										{% else %}
										<li class="list-group-item list-item-title list-item-hidden" data-repo-id="{{ repos.id }}">
										  	<a href="{{ repos.html_url }}">{{ repos.name }}
										  		<i class="fas fa-sort-down"></i>
										  		<div class="list-item-expanded">
										  			{{ repos.description }}
										  		</div>
										  	</a>
										</li>
									{% endif %}
								{% endfor %}

							</ul>
						</div>
						<div id="public-gist-box" class="col-md-4 dynamic-content"> 	
							<h5>
								<i class="fas fa-file-code"></i>
								public gists
							</h5>
							<ul id="public-gist-list" class="list-group list-group-flush">
							</ul>
							<div class='loading-spinner'><i class='fas fa-circle-notch'></i></div>
						</div>
					</div><!-- /.row -->
				</div><!-- /.container -->
				<div class="container">
					<div id="quote-box" class="row">
						<div class="col-md-12">
							<p>
								{{ page.quote }}
							</p>
						</div>
					</div>
				</div>
			</div><!-- /#main-content -->

			<div class="container">
			<footer>
	    		<ul>
	        		<li><a href="mailto:jerrycoe2@gmail.com">email</a></li>
	        		<li><a href="https://github.com/jerrycoe">github.com/jerrycoe</a></li>
				</ul>
			</footer>
			</div>
			<script>
				$(document).ready(function(){
					var site = {{ site.github | jsonify }};
					var repos = {{ site.github.public_repositories | jsonify }};
					var ajaxResult = [];
				   	$.ajax({
				   		section: '#public-gist-box',
				   		beforeSend: function(){
				   			$(this.section).find(".loading-spinner").show();
				   		},
						method: "GET",
						cache: true,
						url: "https://api.github.com/users/jerrycoe/gists"
					})
					.done(function( msg ) {
						for(var i = 0; i < msg.length; i++){
							descriptionExcerpt = msg[i].description.substring(0,27)+'...';
							if(i < 3){
								$("#public-gist-list").append('<li class="list-group-item list-item-title list-item-preview" data-gist-id="'+msg[i].id+'"><a href="'+msg[i].html_url+'">'+ descriptionExcerpt +'</a></li>')
							}else{
								$("#public-gist-list").append('<li class="list-group-item list-item-title list-item-hidden" data-gist-id="'+msg[i].id+'"><a href="'+msg[i].html_url+'">'+ descriptionExcerpt +'</a></li>')
							}
						}
						$(this.section).find( ".loading-spinner" ).hide();
						$(this.section).addClass('content-loaded');
					});
					for ( var i = 0; i < repos.length; i++ )
					{
					   	$.ajax({

							method: "GET",
							cache: true,
							async: false,
						 	//url: "https://api.github.com/repos/jerrycoe/"+repos[i].name+"/stats/contributors",
							url: "https://api.github.com/repos/jerrycoe/"+repos[i].name+"/languages",
							repos: repos,
							index: i,
						})
						.done(function( msg ) {
							ajaxResult.push(msg);
						});
					}
					var newArr = [];
					for(var i = 0; i < ajaxResult.length; i++){
						var keys = Object.keys(ajaxResult[i]);
						for(var j = 0; j < keys.length; j++)
						{
							newArr.push(keys[j]);
						}
					}

					function onlyUnique(value, index, self) { 
					    return self.indexOf(value) === index;
					}
					var uniqueGitLanguages = newArr.filter( onlyUnique );

					$(document).on('expandListItem','.list-group-item a', function(event){
						$(this).toggleClass('expanded');
						if($(this).hasClass('expanded')){
							$(this).find('i').removeClass('fa-sort-down').addClass('fa-sort-up');
						}else{
							$(this).find('i').removeClass('fa-sort-up').addClass('fa-sort-down');
						}
						$($(this).find('.list-item-expanded')[0]).slideToggle( 500 ,function(event){
						});
					});

					$(document).on('click', '#public-repo-list li a', function(event){
						event.preventDefault();
						$(event.target).trigger('expandListItem');
					});

				});
			</script>
		</body>
	</html>